name: Djangular Package and Deploy

on:
  push:
    branches:
      - alex-django-angular-test
  workflow_dispatch:
  
jobs: 
  test_ssh:
    runs-on: ubuntu-20.04
    name: copy private key from repo secret
    steps:
      - name: create private key file
        env:
          SSH_KEY: ${{ secrets.SSH_KEY }}
        run: |
          mkdir ~/.ssh
          cd ~/.ssh/
          echo "$SSH_KEY" > cs673-ssh-key.pem
          chmod 400 cs673-ssh-key.pem
          ssh -i "cs673-ssh-key.pem" ec2-user@44.199.212.24

  cleanup:
      - name: delete private key file
        if: always()
        run: |
          sudo rm ~/.ssh/cs673-ssh-key.pem